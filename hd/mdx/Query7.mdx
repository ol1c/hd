-- 7. Które sale odnotowały największy wzrost, a które największy spadek liczby odwiedzin po rotacji wystaw?
WITH
MEMBER [Measures].[Visits - Current Month] AS
([Measures].[Visit Count], [Date].[Date Hierarchy].CurrentMember)
MEMBER [Measures].[Visits - Previous Month] AS
([Measures].[Visit Count],
ParallelPeriod([Date].[Date Hierarchy].[Month], 1, [Date].[Date Hierarchy].CurrentMember))
MEMBER [Measures].[Visits Change] AS
[Measures].[Visits - Current Month] - [Measures].[Visits - Previous Month]
SELECT
{
[Measures].[Visits - Current Month],
[Measures].[Visits - Previous Month],
[Measures].[Visits Change]
} ON COLUMNS,
{
	TopCount([Room].[Number].Members, 3, [Measures].[Visits Change]),
	BottomCount([Room].[Number].Members, 3, [Measures].[Visits Change])
} ON ROWS
FROM [Museum DB 1]
WHERE (
[Date].[Date Hierarchy].[Month].&[12]
)